import{_ as V,b as f,r as W,o as C,T as q,w as i,f as s,c as n,h as _,g as r,a0 as S,B as F,u as K,au as Q,d as Y,e as U,F as ee,W as te,Z as D,X as $,j as u,k as b,aq as se,ap as ae}from"./index-0WvK6C2i.js";import{S as oe,T as le}from"./SearchForm-BKyQ_HQc.js";import{_ as ne}from"./Title-jzmMLXXF.js";import{W as ie}from"./WForm-N4Mosagg.js";import{_ as re}from"./index-BacwxZLG.js";import{c as ce}from"./channelStore-DRH7tsLD.js";import{_ as de}from"./index-CQYqznZm.js";import{a as ue,_ as pe}from"./index-CDWfSvXp.js";import"./index-usPi87uD.js";import"./Col-QspOhJ19.js";import"./debounce-cOzjl19W.js";import"./index-sQ36ty4v.js";import"./List-CzR7Ze3u.js";const me=["src"],_e=["src"],fe={class:"footer"},ge={__name:"Detail",setup(j,{expose:v}){const p=f({}),y=f(!1);f("警告原图"),f(!1);const M=h=>{p.value=h,y.value=!0},g=()=>{y.value=!1},k=[{type:"text",label:"告警类别",key:"alarmType"},{type:"text",label:"告警标识",key:"alarmId"},{type:"text",label:"视频通道",key:"mediaName"},{type:"text",label:"上报情况",key:"pushStatus"},{type:"slot",label:"抓拍图",key:"Path"}];return W(["警告原图","前端标注图",{value:"后端标注图",disabled:!0}]),v({showDrawer:M}),(h,m)=>{const w=ne,A=F,E=re;return C(),q(E,{open:r(y),"onUpdate:open":m[1]||(m[1]=x=>S(y)?y.value=x:null),title:"告警详情",width:"48%","footer-style":{textAlign:"right"},onClose:g},{footer:i(()=>[s("div",fe,[n(A,{class:"close",onClick:g},{default:i(()=>m[2]||(m[2]=[_("取消")])),_:1})])]),default:i(()=>[n(w,{title:"告警明细",class:"detail-info-title"}),n(ie,{modelValue:r(p),"onUpdate:modelValue":m[0]||(m[0]=x=>S(p)?p.value=x:null),formList:k,labelWidth:"100px"},{Path:i(()=>[s("img",{src:r(p).Path,style:{width:"200px"}},null,8,me)]),_:1},8,["modelValue"]),n(w,{title:"告警预览",class:"detail-info-title title"}),s("img",{src:r(p).Path,style:{width:"100%"}},null,8,_e)]),_:1},8,["open"])}}},ve=V(ge,[["__scopeId","data-v-7158977c"]]),ye={class:"alarm-container"},ke={class:"alarm-box"},he={class:"flex"},be=["src"],xe={class:"item-label"},Ne={class:"item"},De={class:"content"},Se={class:"item"},we={class:"content"},Te={class:"item"},Le={class:"content"},Ce={class:"item"},Me={class:"item-alarm"},Ae={class:"content"},Ee={class:"footer"},ze={class:"footer-delete"},Be={class:"select-text"},$e={__name:"index",setup(j){const{SEND_MESSAGE:v}=K();ce();const{alarmData:p,DELETE_ALARM:y,DELETE_ALL_ALARM:M}=Q(),g=f([]),k=f(12),h=f(1),m=W({taskName:"",mediaName:"",Time:[],alarmMsg:""}),w=Y(()=>{const{taskName:t,mediaName:e,Time:d,alarmMsg:l}=m,a=p.filter(N=>{let c=!0;if(t&&(c=c&&N.taskName.includes(t)),e&&(c=c&&N.mediaName.includes(e)),d&&d.length===2){const[o,B]=d,Z=$(o+" 00:00:00"),H=$(B+" 23:59:59"),R=$(N.Time);c=c&&R.isAfter(Z)&&R.isBefore(H)}return l&&(c=c&&N.alarmMsg===l),c}),L=(h.value-1)*k.value,z=L+k.value;return a.slice(L,z)}),A=t=>{Object.assign(m,t)},E=(t,e)=>{console.log(t,e)},x=f(""),I=t=>{x.value.showDrawer(t)},P=t=>{const e=t.map(a=>a.jpgPath),d=t.map(a=>a.id),l={type:"clearJpgFiles",fileUrls:e};u.on(l.type,a=>{a.result===0?(b.success("操作成功"),y(d)):b.error("请求失败"),u.off(l.type)}),v(l)},J=()=>{const t={type:"clearAllJpg"};u.on(t.type,e=>{e.result===0?(b.success("操作成功"),M()):b.error("请求失败"),u.off(t.type)}),v(t)},T=f([{type:"select",key:"taskName",label:"警告任务",list:[]},{type:"select",key:"mediaName",label:"视频通道",list:[]},{type:"range",key:"Time",label:"警告时间"},{type:"select",key:"alarmMsg",label:"警告内容",list:[]}]),G=()=>{const t={type:"getMediaChannelList"};u.on(t.type,e=>{if(e.result===0){const l=e.data.channels.filter(a=>a.mediaDelete==0).map(a=>({label:a.mediaName,value:a.mediaName}));T.value[1].list=l}else b.error("请求失败");u.off(t.type)}),v(t)},O=()=>{const t={type:"getAiModelList"};u.on(t.type,e=>{if(e.result===0||e.msg){const l=e.data.models.map(a=>({label:a.modelWarning,value:a.modelWarning}));T.value[3].list=l}else b.error("请求失败");u.off(t.type)}),v(t)},X=()=>{const t={type:"getAlgoTaskList"};u.on(t.type,e=>{if(e.result===0||e.msg){const l=e.data.tasks.filter(a=>a.taskDelete!=1).map(a=>({label:a.taskName,value:a.taskName}));T.value[0].list=l}else b.error("请求失败");u.off(t.type)}),v(t)};return G(),X(),O(),(t,e)=>{const d=ae,l=F,a=le,L=pe,z=ue,N=se,c=de;return C(),U("div",ye,[n(oe,{searchList:r(T),isRow:!0,span:5,data:{taskName:null,mediaName:null,Time:null,alarmMsg:null},onChange:A},null,8,["searchList"]),n(N,{value:r(g),"onUpdate:value":e[0]||(e[0]=o=>S(g)?g.value=o:null),style:{width:"100%"}},{default:i(()=>[n(z,{gutter:16,style:{width:"100%"}},{default:i(()=>[(C(!0),U(ee,null,te(r(w),o=>(C(),q(L,{class:"gutter-row",xs:24,sm:12,md:8,lg:6,key:o.id},{default:i(()=>[s("div",ke,[s("div",he,[n(d,{value:o,class:"flex1"},{default:i(()=>[_(" 告警任务: "+D(o.taskName),1)]),_:2},1032,["value"]),n(l,{type:"link",text:"",onClick:B=>I(o)},{default:i(()=>e[4]||(e[4]=[_(" 详情 ")])),_:2},1032,["onClick"])]),s("img",{class:"icon",src:o.Path},null,8,be),s("div",xe,[s("div",Ne,[e[5]||(e[5]=s("div",null,"视频通道：",-1)),s("div",De,D(o.mediaName),1)]),s("div",Se,[e[6]||(e[6]=s("div",null,"告警时间：",-1)),s("div",we,D(o.Time),1)]),s("div",Te,[e[7]||(e[7]=s("div",null,"上报状态：",-1)),s("div",Le,D(o.pushStatus),1)]),s("div",Ce,[e[9]||(e[9]=s("div",null,"告警内容：",-1)),s("div",Me,[s("div",Ae,[n(a,{color:"orange"},{default:i(()=>[_(D(o.alarmMsg),1)]),_:2},1024)]),n(l,{danger:"",class:"delete",onClick:B=>P([o])},{default:i(()=>e[8]||(e[8]=[_(" 删除 ")])),_:2},1032,["onClick"])])])])])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"]),s("div",Ee,[s("div",ze,[s("span",null,[e[10]||(e[10]=_("已选 ")),s("span",Be,D(r(g).length),1),e[11]||(e[11]=_("项"))]),n(l,{type:"primary",class:"footer-btn left",onClick:e[1]||(e[1]=o=>P(r(g)))},{default:i(()=>e[12]||(e[12]=[_(" 删除选中 ")])),_:1}),n(l,{class:"close footer-btn",onClick:J},{default:i(()=>e[13]||(e[13]=[_(" 清空全部 ")])),_:1})]),n(c,{current:r(h),"onUpdate:current":e[2]||(e[2]=o=>S(h)?h.value=o:null),pageSize:r(k),"onUpdate:pageSize":e[3]||(e[3]=o=>S(k)?k.value=o:null),"show-size-changer":"",total:r(p).length,"page-size-options":["12","24","36","48","60"],onShowSizeChange:E},null,8,["current","pageSize","total"])]),n(ve,{ref_key:"detailRef",ref:x},null,512)])}}},Ze=V($e,[["__scopeId","data-v-1493d952"]]);export{Ze as default};
