import{_ as U,b as p,r as V,o as C,T as W,w as i,f as a,c as n,h as f,g as r,a0 as D,B as q,u as K,au as Q,d as Y,e as R,F as ee,W as te,Z as N,X as B,j as d,k as h,aq as se,ap as ae}from"./index-CDi9FOh_.js";import{S as le}from"./SearchForm--UjJCjOT.js";import{_ as oe}from"./Title-uxrGrMCr.js";import{W as ne}from"./WForm-BVYTya9x.js";import{_ as ie}from"./index-p0iKhbEA.js";import{c as re}from"./channelStore-cN1zKdKX.js";import{_ as ce}from"./index-CtcSKe_t.js";import{a as de,_ as ue}from"./index-BOtK7-by.js";import"./index-0U4ReFbg.js";import"./Col-CzT2f1M-.js";import"./debounce-DNYjP2-6.js";import"./index-C8iFosyF.js";import"./List-BBz1pjPz.js";const me=["src"],pe=["src"],_e={class:"footer"},fe={__name:"Detail",setup(F,{expose:g}){const u=p({}),v=p(!1);p("警告原图"),p(!1);const M=k=>{u.value=k,v.value=!0},_=()=>{v.value=!1},y=[{type:"text",label:"告警类别",key:"alarmType"},{type:"text",label:"告警标识",key:"alarmId"},{type:"text",label:"视频通道",key:"mediaName"},{type:"text",label:"上报情况",key:"pushStatus"},{type:"slot",label:"抓拍图",key:"Path"}];return V(["警告原图","前端标注图",{value:"后端标注图",disabled:!0}]),g({showDrawer:M}),(k,m)=>{const S=oe,T=q,A=ie;return C(),W(A,{open:r(v),"onUpdate:open":m[1]||(m[1]=b=>D(v)?v.value=b:null),title:"告警详情",width:"48%","footer-style":{textAlign:"right"},onClose:_},{footer:i(()=>[a("div",_e,[n(T,{class:"close",onClick:_},{default:i(()=>m[2]||(m[2]=[f("取消")])),_:1})])]),default:i(()=>[n(S,{title:"告警明细",class:"detail-info-title"}),n(ne,{modelValue:r(u),"onUpdate:modelValue":m[0]||(m[0]=b=>D(u)?u.value=b:null),formList:y,labelWidth:"100px"},{Path:i(()=>[a("img",{src:r(u).Path,style:{width:"200px"}},null,8,me)]),_:1},8,["modelValue"]),n(S,{title:"告警预览",class:"detail-info-title title"}),a("img",{src:r(u).Path,style:{width:"100%"}},null,8,pe)]),_:1},8,["open"])}}},ge=U(fe,[["__scopeId","data-v-7158977c"]]),ve={class:"alarm-container"},ye={class:"alarm-box"},ke={class:"flex"},he=["src"],be={class:"item-label"},xe={class:"item"},Ne={class:"content"},De={class:"item"},Se={class:"content"},we={class:"item"},Le={class:"content"},Ce={class:"item"},Me={class:"item-alarm"},Te={class:"content"},Ae={class:"footer"},Ee={class:"footer-delete"},ze={class:"select-text"},Be={__name:"index",setup(F){const{SEND_MESSAGE:g}=K();re();const{alarmData:u,DELETE_ALARM:v,DELETE_ALL_ALARM:M}=Q(),_=p([]),y=p(10),k=p(1),m=V({taskName:"",mediaName:"",Time:[],alarmMsg:""}),S=Y(()=>{const{taskName:t,mediaName:e,Time:c,alarmMsg:o}=m,l=u.filter(x=>{let s=!0;if(t&&(s=s&&x.taskName.includes(t)),e&&(s=s&&x.mediaName.includes(e)),c&&c.length===2){const[z,X]=c,Z=B(z+" 00:00:00"),H=B(X+" 23:59:59"),P=B(x.Time);s=s&&P.isAfter(Z)&&P.isBefore(H)}return o&&(s=s&&x.alarmMsg===o),s}),L=(k.value-1)*y.value,E=L+y.value;return l.slice(L,E)}),T=t=>{Object.assign(m,t)},A=(t,e)=>{console.log(t,e)},b=p(""),j=t=>{b.value.showDrawer(t)},$=t=>{const e=t.map(l=>l.jpgPath),c=t.map(l=>l.id),o={type:"clearJpgFiles",fileUrls:e};d.on(o.type,l=>{l.result===0?(h.success("操作成功"),v(c)):h.error("请求失败"),d.off(o.type)}),g(o)},I=()=>{const t={type:"clearAllJpg"};d.on(t.type,e=>{e.result===0?(h.success("操作成功"),M()):h.error("请求失败"),d.off(t.type)}),g(t)},w=p([{type:"select",key:"taskName",label:"警告任务",list:[]},{type:"select",key:"mediaName",label:"视频通道",list:[]},{type:"range",key:"Time",label:"警告时间"},{type:"select",key:"alarmMsg",label:"警告内容",list:[]}]),J=()=>{const t={type:"getMediaChannelList"};d.on(t.type,e=>{if(e.result===0){const o=e.data.channels.filter(l=>l.mediaDelete==0).map(l=>({label:l.mediaName,value:l.mediaName}));w.value[1].list=o}else h.error("请求失败");d.off(t.type)}),g(t)},G=()=>{const t={type:"getAiModelList"};d.on(t.type,e=>{if(e.result===0||e.msg){const o=e.data.models.map(l=>({label:l.modelWarning,value:l.modelWarning}));w.value[3].list=o}else h.error("请求失败");d.off(t.type)}),g(t)},O=()=>{const t={type:"getAlgoTaskList"};d.on(t.type,e=>{if(e.result===0||e.msg){const o=e.data.tasks.filter(l=>l.taskDelete!=1).map(l=>({label:l.taskName,value:l.taskName}));w.value[0].list=o}else h.error("请求失败");d.off(t.type)}),g(t)};return J(),O(),G(),(t,e)=>{const c=ae,o=q,l=ue,L=de,E=se,x=ce;return C(),R("div",ve,[n(le,{searchList:r(w),isRow:!0,span:5,data:{taskName:null,mediaName:null,Time:null,alarmMsg:null},onChange:T},null,8,["searchList"]),n(E,{value:r(_),"onUpdate:value":e[0]||(e[0]=s=>D(_)?_.value=s:null),style:{width:"100%"}},{default:i(()=>[n(L,{gutter:16,style:{width:"100%"}},{default:i(()=>[(C(!0),R(ee,null,te(r(S),s=>(C(),W(l,{class:"gutter-row",xs:24,sm:12,md:8,lg:6,key:s.id},{default:i(()=>[a("div",ye,[a("div",ke,[n(c,{value:s,class:"flex1"},{default:i(()=>[f(" 告警任务: "+N(s.taskName),1)]),_:2},1032,["value"]),n(o,{type:"link",text:"",onClick:z=>j(s)},{default:i(()=>e[4]||(e[4]=[f(" 详情 ")])),_:2},1032,["onClick"])]),a("img",{class:"icon",src:s.Path},null,8,he),a("div",be,[a("div",xe,[e[5]||(e[5]=a("div",null,"视频通道：",-1)),a("div",Ne,N(s.mediaName),1)]),a("div",De,[e[6]||(e[6]=a("div",null,"告警时间：",-1)),a("div",Se,N(s.Time),1)]),a("div",we,[e[7]||(e[7]=a("div",null,"上报状态：",-1)),a("div",Le,N(s.pushStatus),1)]),a("div",Ce,[e[9]||(e[9]=a("div",null,"告警内容：",-1)),a("div",Me,[a("div",Te,N(s.alarmMsg),1),n(o,{danger:"",class:"delete",onClick:z=>$([s])},{default:i(()=>e[8]||(e[8]=[f(" 删除 ")])),_:2},1032,["onClick"])])])])])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"]),a("div",Ae,[a("div",Ee,[a("span",null,[e[10]||(e[10]=f("已选 ")),a("span",ze,N(r(_).length),1),e[11]||(e[11]=f("项"))]),n(o,{type:"primary",class:"footer-btn left",onClick:e[1]||(e[1]=s=>$(r(_)))},{default:i(()=>e[12]||(e[12]=[f(" 删除选中 ")])),_:1}),n(o,{class:"close footer-btn",onClick:I},{default:i(()=>e[13]||(e[13]=[f(" 清空全部 ")])),_:1})]),n(x,{current:r(k),"onUpdate:current":e[2]||(e[2]=s=>D(k)?k.value=s:null),pageSize:r(y),"onUpdate:pageSize":e[3]||(e[3]=s=>D(y)?y.value=s:null),"show-size-changer":"",total:r(u).length,onShowSizeChange:A},null,8,["current","pageSize","total"])]),n(ge,{ref_key:"detailRef",ref:b},null,512)])}}},Xe=U(Be,[["__scopeId","data-v-aceb05d0"]]);export{Xe as default};
